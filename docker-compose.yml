services:
  code-review-council:
    build:
      context: ..
      dockerfile: code-review-council/Dockerfile
    working_dir: /repo
    volumes:
      # Target codebase to review (override REPO_PATH in .env or via command line)
      - ${REPO_PATH:-.}:/repo:ro
      # Config file (optional, can use CONFIG_JSON env var instead)
      - ./review-council.config.json:/app/code-review-council/review-council.config.json:ro
      # Mount only necessary auth credentials for AI CLI tools
      - ~/.config/github-copilot:/home/node/.config/github-copilot:ro
      - ~/.config/gemini:/home/node/.config/gemini:ro
      - ~/.claude:/home/node/.claude:ro
    environment:
      # Optional overrides:
      # CONFIG_JSON: '{"reviewers": [...], ...}'
      # DECISION_MAKER_MODEL: claude-sonnet-4-5-20250929
      # REVIEW_LANGUAGE: zh-tw
      # REVIEWER_TIMEOUT_MS: "120000"
      # COPILOT_SDK_AUTH_TOKEN: ${COPILOT_SDK_AUTH_TOKEN:-}
      NODE_ENV: production
